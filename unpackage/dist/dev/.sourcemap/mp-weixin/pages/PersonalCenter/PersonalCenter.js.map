{"version":3,"file":"PersonalCenter.js","sources":["pages/PersonalCenter/PersonalCenter.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovQ29kZS91bmktYXBwUHJvamVjdC91bmkvcGFnZXMvUGVyc29uYWxDZW50ZXIvUGVyc29uYWxDZW50ZXIudnVl"],"sourcesContent":["<template>\r\n  <view class=\"profile-container\">\r\n    <!-- 未登录状态 -->\r\n    <view v-if=\"isLogin === false\" class=\"not-logged-in\">\r\n      <login />\r\n    </view>\r\n    \r\n    <!-- 已登录状态 -->\r\n    <view v-else class=\"logged-in\">\r\n      <!-- 个人信息 -->\r\n      <view class=\"user-info\">\r\n        <image class=\"avatar\" :src=\"imgBaseUrl+userDetail.avatar\" mode=\"aspectFill\"></image>\r\n        <view class=\"info\">\r\n          <text class=\"name\">{{ userDetail.username }}</text>\r\n          <text class=\"email\">email: {{ userDetail.email }}</text>\r\n          <text class=\"phone\">phone: {{ userDetail.phone }}</text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 个人信息设置 -->\r\n      <view class=\"settings\">\r\n        <view class=\"cell\" @tap=\"toggleSettings\">\r\n          <text class=\"cell-title\">个人信息设置</text>\r\n          <text class=\"iconfont icon-arrow-right\"></text>\r\n        </view>\r\n        \r\n        <view v-if=\"showSettings\" class=\"settings-form\">\r\n          <view class=\"form-item\">\r\n            <text class=\"form-label\">头像</text>\r\n            <view class=\"form-input\">\r\n              <img-uploader v-model:img-src=\"editInfo.avatar\"></img-uploader>\r\n            </view>\r\n          </view>\r\n          \r\n          <view class=\"form-item\">\r\n            <text class=\"form-label\">名称</text>\r\n            <input class=\"form-input\" v-model=\"editInfo.username\" placeholder=\"请输入名称\" />\r\n          </view>\r\n          \r\n          <view class=\"form-item\">\r\n            <text class=\"form-label\">邮箱</text>\r\n            <input class=\"form-input\" v-model=\"editInfo.email\" placeholder=\"请输入邮箱\" />\r\n          </view>\r\n          \r\n          <view class=\"form-item\">\r\n            <text class=\"form-label\">手机号</text>\r\n            <input class=\"form-input\" v-model=\"editInfo.phone\" placeholder=\"请输入手机号\" />\r\n          </view>\r\n          \r\n          <button class=\"save-button\" type=\"primary\" @tap=\"saveInfo\">保存</button>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 我的关注、我的粉丝、系统消息 -->\r\n      <view class=\"cell\" @tap=\"navigateTo('/pages/PersonalCenter/MyFollow')\">\r\n        <text class=\"cell-title\">我的关注</text>\r\n        <text class=\"iconfont icon-arrow-right\"></text>\r\n      </view>\r\n      \r\n      <view class=\"cell\" @tap=\"navigateTo('/pages/PersonalCenter/MyFan')\">\r\n        <text class=\"cell-title\">我的粉丝</text>\r\n        <text class=\"iconfont icon-arrow-right\"></text>\r\n      </view>\r\n      \r\n      <view class=\"cell\" @tap=\"navigateTo('/pages/PersonalCenter/SystemInfo')\">\r\n        <text class=\"cell-title\">系统消息</text>\r\n        <text class=\"iconfont icon-arrow-right\"></text>\r\n      </view>\r\n\r\n      <!-- 退出登录 -->\r\n      <button class=\"logout-button\" @tap=\"logout\">退出登录</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue';\r\nimport { useUserStore } from \"@/store/userStore\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { imgBaseUrl } from \"@/util/basic-data\";\r\nimport ImgUploader from \"@/components/ImgUploader/ImgUploader.vue\";\r\nimport Login from \"@/components/Login/Login.vue\";\r\nimport { userEditInfo, userQuit } from \"@/api/userAPI\";\r\n\r\nconst userStore = useUserStore();\r\n// 登录状态\r\nconst { userDetail, isLogin } = storeToRefs(userStore);\r\n\r\n// 编辑信息\r\nconst editInfo = computed(() => {\r\n  return {\r\n    avatar: userDetail.value.avatar,\r\n    username: userDetail.value.username,\r\n    email: userDetail.value.email,\r\n    phone: userDetail.value.phone,\r\n  };\r\n});\r\n\r\n// 是否显示设置表单\r\nconst showSettings = ref(false);\r\n\r\n// 切换设置表单显示状态\r\nconst toggleSettings = () => {\r\n  showSettings.value = !showSettings.value;\r\n};\r\n\r\n// 保存信息\r\nconst saveInfo = async () => {\r\n  try {\r\n    await userEditInfo(editInfo.value);\r\n    uni.showToast({\r\n      title: '保存成功',\r\n      icon: 'success'\r\n    });\r\n  } catch (error) {\r\n    uni.showToast({\r\n      title: '保存失败',\r\n      icon: 'none'\r\n    });\r\n  }\r\n};\r\n\r\n// 页面导航\r\nconst navigateTo = (url) => {\r\n  uni.navigateTo({\r\n    url\r\n  });\r\n};\r\n\r\n// 退出登录\r\nconst logout = async () => {\r\n  uni.showModal({\r\n    title: '提示',\r\n    content: '确定要退出登录吗？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        try {\r\n          await userQuit();\r\n          // 可能需要重定向到登录页面或首页\r\n          uni.switchTab({\r\n            url: '/pages/Index/Index'\r\n          });\r\n        } catch (error) {\r\n          uni.showToast({\r\n            title: '退出失败',\r\n            icon: 'none'\r\n          });\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\n</script>\r\n\r\n<style>\r\n.profile-container {\r\n  padding: 40rpx;\r\n}\r\n\r\n.not-logged-in {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 200rpx;\r\n}\r\n\r\n.logged-in {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 40rpx;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 40rpx;\r\n}\r\n\r\n.avatar {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  border-radius: 50%;\r\n}\r\n\r\n.info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10rpx;\r\n}\r\n\r\n.name {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n}\r\n\r\n.email,\r\n.phone {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.cell {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 30rpx 0;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.cell-title {\r\n  font-size: 32rpx;\r\n}\r\n\r\n.settings-form {\r\n  padding: 20rpx;\r\n  background-color: #f7f8fa;\r\n  border-radius: 16rpx;\r\n  margin-top: 20rpx;\r\n}\r\n\r\n.form-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 20rpx 0;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.form-label {\r\n  width: 140rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.form-input {\r\n  flex: 1;\r\n}\r\n\r\n.save-button {\r\n  margin-top: 30rpx;\r\n  background-color: #2979ff;\r\n  color: #fff;\r\n}\r\n\r\n.logout-button {\r\n  margin-top: 60rpx;\r\n  background-color: #ff9800;\r\n  color: #fff;\r\n}\r\n</style> ","import Component from 'D:/Code/uni-appProject/uni/pages/PersonalCenter/PersonalCenter.vue'\nwx.createComponent(Component)"],"names":["useUserStore","storeToRefs","computed","ref","userEditInfo","uni","userQuit","Component"],"mappings":";;;;;;;;AAgFA,MAAM,cAAc,MAAW;AAC/B,MAAM,QAAQ,MAAW;;;;AAGzB,UAAM,YAAYA,gBAAY,aAAA;AAE9B,UAAM,EAAE,YAAY,QAAO,IAAKC,cAAW,YAAC,SAAS;AAGrD,UAAM,WAAWC,cAAQ,SAAC,MAAM;AAC9B,aAAO;AAAA,QACL,QAAQ,WAAW,MAAM;AAAA,QACzB,UAAU,WAAW,MAAM;AAAA,QAC3B,OAAO,WAAW,MAAM;AAAA,QACxB,OAAO,WAAW,MAAM;AAAA,MAC5B;AAAA,IACA,CAAC;AAGD,UAAM,eAAeC,cAAAA,IAAI,KAAK;AAG9B,UAAM,iBAAiB,MAAM;AAC3B,mBAAa,QAAQ,CAAC,aAAa;AAAA,IACrC;AAGA,UAAM,WAAW,YAAY;AAC3B,UAAI;AACF,cAAMC,YAAY,aAAC,SAAS,KAAK;AACjCC,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAGA,UAAM,aAAa,CAAC,QAAQ;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACb;AAAA,MACJ,CAAG;AAAA,IACH;AAGA,UAAM,SAAS,YAAY;AACzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,gBAAI;AACF,oBAAMC,YAAQ,SAAA;AAEdD,4BAAAA,MAAI,UAAU;AAAA,gBACZ,KAAK;AAAA,cACjB,CAAW;AAAA,YACF,SAAQ,OAAO;AACdA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtJA,GAAG,gBAAgBE,SAAS;"}