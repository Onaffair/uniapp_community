<!-- #ifdef H5 -->
<template>
    <view class="dashboard">
        <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
        <view v-if="loading" class="loading">
            <text>Âä†ËΩΩ‰∏≠...</text>
        </view>

        <!-- ÈîôËØØÁä∂ÊÄÅ -->
        <view v-else-if="error" class="error">
            <text>{{ error }}</text>
            <button @click="fetchAllData" class="retry-btn">ÈáçËØï</button>
        </view>

        <!-- ‰∏ªË¶ÅÂÜÖÂÆπ -->
        <view v-else class="dashboard-content">
            <!-- ÁªüËÆ°Âç°Áâá -->
            <view class="stats-grid">
                <view class="stat-card">
                    <view class="stat-icon user-icon">üë•</view>
                    <view class="stat-info">
                        <text class="stat-number">{{ stats.userCount }}</text>
                        <text class="stat-label">Áî®Êà∑ÊÄªÊï∞</text>
                        <text class="stat-desc">ËæÉ‰∏äÂë®
                            <text :class="stats.userGrowth > 0 ? 'up' : 'down'">{{
                                    stats.userGrowth > 0 ? '+' : ''
                                }}{{ stats.userGrowth }}%
                            </text>
                        </text>
                    </view>
                </view>

                <view class="stat-card">
                    <view class="stat-icon activity-icon">üéØ</view>
                    <view class="stat-info">
                        <text class="stat-number">{{ stats.activityCount }}</text>
                        <text class="stat-label">Ê¥ªÂä®ÊÄªÊï∞</text>
                        <text class="stat-desc">ËæÉ‰∏äÂë®
                            <text :class="stats.activityGrowth > 0 ? 'up' : 'down'">
                                {{ stats.activityGrowth > 0 ? '+' : '' }}{{ stats.activityGrowth }}%
                            </text>
                        </text>
                    </view>
                </view>

                <view class="stat-card">
                    <view class="stat-icon group-icon">üë´</view>
                    <view class="stat-info">
                        <text class="stat-number">{{ stats.groupCount }}</text>
                        <text class="stat-label">Áæ§ÁªÑÊÄªÊï∞</text>
                        <text class="stat-desc">ËæÉ‰∏äÂë®
                            <text :class="stats.groupGrowth > 0 ? 'up' : 'down'">{{
                                    stats.groupGrowth > 0 ? '+' : ''
                                }}{{ stats.groupGrowth }}%
                            </text>
                        </text>
                    </view>
                </view>

                <view class="stat-card">
                    <view class="stat-icon active-icon">‚ö°</view>
                    <view class="stat-info">
                        <text class="stat-number">{{ stats.activeToday }}</text>
                        <text class="stat-label">‰ªäÊó•Ê¥ªË∑É</text>
                        <text class="stat-desc">ËæÉÊò®Êó•
                            <text :class="stats.activeGrowth > 0 ? 'up' : 'down'">{{
                                    stats.activeGrowth > 0 ? '+' : ''
                                }}{{ stats.activeGrowth }}%
                            </text>
                        </text>
                    </view>
                </view>
            </view>

            <!-- ÂõæË°®Âå∫Âüü -->
            <view class="charts-section">
                <!-- Áî®Êà∑Â¢ûÈïøË∂ãÂäøÂõæ -->
                <view class="chart-card">
                    <view class="chart-header">
                        <text class="chart-title">Áî®Êà∑Â¢ûÈïøË∂ãÂäø</text>
                    </view>
                    <view class="chart-content">
                        <view class="line-chart">
                            <view class="chart-y-axis">
                                <text v-for="(value, index) in yAxisValues" :key="index" class="y-axis-label">{{
                                        value
                                    }}
                                </text>
                            </view>
                            <view class="chart-area">
                                <view class="chart-grid">
                                    <view v-for="i in 5" :key="i" class="grid-line"></view>
                                </view>
                                <view class="chart-line">
                                    <view
                                        v-for="(point, index) in userGrowthData"
                                        :key="index"
                                        class="data-point"
                                        :style="{ left: (index * 100 / (userGrowthData.length - 1)) + '%', bottom: (point.value / Math.max(...userGrowthData.map(d => d.value)) * 100) + '%' }"
                                    ></view>
                                </view>
                            </view>
                            <view class="chart-x-axis">
                                <text v-for="(month, index) in months" :key="index" class="x-axis-label">{{
                                        month
                                    }}
                                </text>
                            </view>
                        </view>
                    </view>
                </view>

                <!-- Ê¥ªÂä®ÂàÜÁ±ªÁªüËÆ°È•ºÂõæ -->
                <view class="chart-card">
                    <view class="chart-header">
                        <text class="chart-title">Ê¥ªÂä®ÂàÜÁ±ªÁªüËÆ°</text>
                    </view>
                    <view class="chart-content">
                        <view class="pie-chart-container">
                            <view class="pie-chart" :style="pieChartStyle">
                            </view>
                            <view class="pie-legend">
                                <view
                                    v-for="(category, index) in activityCategories"
                                    :key="category.id"
                                    class="legend-item"
                                    :class="{ highlighted: highlightedCategory === category.id }"
                                    @click="highlightCategory(category.id)"
                                >
                                    <view class="legend-color"
                                          :style="{ backgroundColor: getCategoryColor(index) }"></view>
                                    <text class="legend-text">{{ category.name }}
                                        ({{ activityCategoryCounts[category.id] || 0 }})
                                    </text>
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>

            <!-- ÊúÄÊñ∞Êï∞ÊçÆ -->
            <view class="latest-section">
                <!-- ÊúÄÊñ∞Áî®Êà∑ -->
                <view class="latest-card">
                    <view class="latest-header">
                        <text class="latest-title">ÊúÄÊñ∞Áî®Êà∑</text>
                        <text class="more-link" @click="navigateTo('/pages/admin/Users')">Êü•ÁúãÊõ¥Â§ö</text>
                    </view>
                    <view class="latest-content">
                        <view
                            v-for="user in latestUsers"
                            :key="user.id"
                            class="user-item"
                        >
                            <view class="user-avatar">
                                <image v-if="user.avatar" :src="imgBaseUrl + user.avatar" class="user-avatar-img"
                                       mode="aspectFill"/>
                                <view v-else class="user-avatar-placeholder">{{
                                        user.username?.charAt(0) || 'U'
                                    }}
                                </view>
                            </view>
                            <view class="user-info">
                                <text class="user-name">{{ user.username }}</text>
                                <text class="user-email">{{ user.email }}</text>
                            </view>
                            <view class="user-status">
                                <text :class="getStatusClass(user.status)">{{ getStatusText(user.status) }}</text>
                            </view>
                        </view>
                    </view>
                </view>

                <!-- ÊúÄÊñ∞Ê¥ªÂä® -->
                <view class="latest-card">
                    <view class="latest-header">
                        <text class="latest-title">ÊúÄÊñ∞Ê¥ªÂä®</text>
                        <text class="more-link" @click="navigateTo('/pages/admin/Activities')">Êü•ÁúãÊõ¥Â§ö</text>
                    </view>
                    <view class="latest-content">
                        <view
                            v-for="activity in latestActivities"
                            :key="activity.id"
                            class="activity-item"
                        >
                            <view class="activity-info">
                                <text class="activity-title">{{ activity.title }}</text>
                                <text class="activity-meta">{{ activity.address }} ‚Ä¢ {{
                                        formatDate(activity.beginTime)
                                    }}
                                </text>
                            </view>
                            <view class="activity-status">
                                <text :class="getActivityStatusClass(activity.status)">
                                    {{ getActivityStatusText(activity.status) }}
                                </text>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>
</template>

<script setup>
import {ref, computed, onMounted} from 'vue'
import {getAllUsers, getAllActivities, getAllGroups} from '@/api/adminAPI'
import {useActivityStore} from '@/store/activityStore'
import {imgBaseUrl} from '@/util/basic-data.js'

const activityStore = useActivityStore()

// Áä∂ÊÄÅÁÆ°ÁêÜ
const loading = ref(true)
const error = ref('')

// ÁªüËÆ°Êï∞ÊçÆ
const stats = ref({
    userCount: 0,
    activityCount: 0,
    groupCount: 0,
    activeToday: 0,
    userGrowth: 0,
    activityGrowth: 0,
    groupGrowth: 0,
    activeGrowth: 0
})

// Áî®Êà∑Â¢ûÈïøÊï∞ÊçÆ
const userGrowthData = ref([])

// Êúà‰ªΩÊï∞ÊçÆ
const months = computed(() => userGrowthData.value.map(item => item.month))

// YËΩ¥Êï∞ÂÄº
const yAxisValues = computed(() => {
    const maxValue = Math.max(...userGrowthData.value.map(d => d.value))
    return Array.from({length: 6}, (_, i) => Math.round(maxValue * (5 - i) / 5))
})

// Ê¥ªÂä®ÂàÜÁ±ªÊï∞ÊçÆ
const activityCategories = computed(() => {
    return activityStore.categoryList.filter(cat => cat.id !== 0) // ÊéíÈô§"ÊâÄÊúâÂàÜÁ±ª"
})

const activityCategoryCounts = ref({})
const highlightedCategory = ref(null)

// ÊúÄÊñ∞Áî®Êà∑ÂíåÊ¥ªÂä®
const latestUsers = ref([])
const latestActivities = ref([])

// Ëé∑ÂèñÂàÜÁ±ªÈ¢úËâ≤
const getCategoryColor = (index) => {
    const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F']
    return colors[index % colors.length]
}

// ËÆ°ÁÆóÈ•ºÂõæÊ†∑Âºè
const pieChartStyle = computed(() => {
    return {
        background: `conic-gradient(${generateConicGradient()})`
    }
})

// ÁîüÊàêÂúÜÈî•Ê∏êÂèò
const generateConicGradient = () => {
    const total = Object.values(activityCategoryCounts.value).reduce((sum, count) => sum + count, 0)


    if (total === 0) return '#f0f0f0 0deg 360deg'

    let currentAngle = 0
    const segments = []

    activityCategories.value.forEach((category, index) => {
        const count = activityCategoryCounts.value[category.id] || 0
        const percentage = count / total
        const angle = percentage * 360
        const color = getCategoryColor(index)



        if (angle > 0) {
            segments.push(`${color} ${currentAngle}deg ${currentAngle + angle}deg`)
            currentAngle += angle
        }
    })



    if (segments.length === 0) {
        return '#f0f0f0 0deg 360deg'
    }

    return segments.join(', ')
}

// Ëé∑ÂèñÈ•ºÂõæÂàáÁâáÊ†∑Âºè
const getPieSliceStyle = (index) => {
    return {
        backgroundColor: getCategoryColor(index)
    }
}

// È´ò‰∫ÆÂàÜÁ±ª
const highlightCategory = (categoryId) => {
    highlightedCategory.value = highlightedCategory.value === categoryId ? null : categoryId
}

// Ëé∑ÂèñÁî®Êà∑Áä∂ÊÄÅÊñáÊú¨
const getStatusText = (status) => {
    const statusMap = {
        'active': 'Ê¥ªË∑É',
        'inactive': 'ÈùûÊ¥ªË∑É',
        'banned': 'Â∑≤Â∞ÅÁ¶Å'
    }
    return statusMap[status] || 'Êú™Áü•'
}

// Ëé∑ÂèñÁî®Êà∑Áä∂ÊÄÅÊ†∑ÂºèÁ±ª
const getStatusClass = (status) => {
    return `status-${status}`
}

// Ëé∑ÂèñÊ¥ªÂä®Áä∂ÊÄÅÊñáÊú¨
const getActivityStatusText = (status) => {
    const statusItem = activityStore.activityStatusList.find(item => item.id === status)
    return statusItem ? statusItem.name : 'Êú™Áü•Áä∂ÊÄÅ'
}

// Ëé∑ÂèñÊ¥ªÂä®Áä∂ÊÄÅÊ†∑ÂºèÁ±ª
const getActivityStatusClass = (status) => {
    const statusMap = {
        1: 'status-waiting',
        2: 'status-active',
        3: 'status-full',
        4: 'status-ongoing',
        5: 'status-ended',
        6: 'status-cancelled'
    }
    return statusMap[status] || 'status-unknown'
}

// Ê†ºÂºèÂåñÊó•Êúü
const formatDate = (dateString) => {
    const date = new Date(dateString)
    return `${date.getMonth() + 1}Êúà${date.getDate()}Êó•`
}

// È°µÈù¢ÂØºËà™
const navigateTo = (url) => {
    uni.navigateTo({url})
}

// Ëé∑ÂèñÊâÄÊúâÊï∞ÊçÆ
const fetchAllData = async () => {
    try {
        loading.value = true
        error.value = ''

        // Âπ∂Ë°åËé∑ÂèñÊâÄÊúâÊï∞ÊçÆ
        const [usersRes, activitiesRes, groupsRes] = await Promise.all([
            getAllUsers(),
            getAllActivities(),
            getAllGroups()
        ])

        if (usersRes?.code === 200) {
            const usersData = usersRes.data || []
            processUsersData(usersData)
        } else if (Array.isArray(usersRes)) {
            // Â¶ÇÊûúÁõ¥Êé•ËøîÂõûÊï∞ÁªÑ
            processUsersData(usersRes)
        } else if (usersRes?.data && Array.isArray(usersRes.data)) {
            // Â¶ÇÊûúdataÂ≠óÊÆµÊòØÊï∞ÁªÑ
            processUsersData(usersRes.data)
        }

        if (activitiesRes?.code === 200) {
            const activitiesData = activitiesRes.data || []
            processActivitiesData(activitiesData)
        } else if (Array.isArray(activitiesRes)) {
            // Â¶ÇÊûúÁõ¥Êé•ËøîÂõûÊï∞ÁªÑ
            processActivitiesData(activitiesRes)
        } else if (activitiesRes?.data && Array.isArray(activitiesRes.data)) {
            // Â¶ÇÊûúdataÂ≠óÊÆµÊòØÊï∞ÁªÑ
            processActivitiesData(activitiesRes.data)
        }

        // Â§ÑÁêÜÁæ§ÁªÑÊï∞ÊçÆ
        if (groupsRes?.code === 200) {
            const groupsData = groupsRes.data || []
            processGroupsData(groupsData)
        } else if (Array.isArray(groupsRes)) {
            // Â¶ÇÊûúÁõ¥Êé•ËøîÂõûÊï∞ÁªÑ
            processGroupsData(groupsRes)
        } else if (groupsRes?.data && Array.isArray(groupsRes.data)) {
            // Â¶ÇÊûúdataÂ≠óÊÆµÊòØÊï∞ÁªÑ
            processGroupsData(groupsRes.data)
        }

    } catch (err) {
        console.error('Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•:', err)
        error.value = 'Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•ÔºåËØ∑ÈáçËØï'
    } finally {
        loading.value = false
    }
}

// Â§ÑÁêÜÁî®Êà∑Êï∞ÊçÆ
const processUsersData = (usersData) => {
    if (!Array.isArray(usersData)) {
        return
    }

    // Êõ¥Êñ∞Áî®Êà∑ÊÄªÊï∞
    stats.value.userCount = usersData.length

    // ËÆ°ÁÆóÁî®Êà∑Â¢ûÈïøË∂ãÂäøÊï∞ÊçÆÔºàÊåâÊúàÁªüËÆ°Ôºâ
    const now = new Date()
    const sixMonthsAgo = new Date()
    sixMonthsAgo.setMonth(now.getMonth() - 5) // Ëé∑ÂèñÂçäÂπ¥ÂÜÖÁöÑÊï∞ÊçÆÔºàÂΩìÂâçÊúà+Ââç5‰∏™ÊúàÔºâ

    // ÂàùÂßãÂåñ6‰∏™ÊúàÁöÑÁªüËÆ°Êï∞ÊçÆ
    const monthlyData = Array(6).fill(0)
    const monthNames = []

    // ËÆæÁΩÆÊúà‰ªΩÂêçÁß∞
    for (let i = 0; i < 6; i++) {
        const d = new Date()
        d.setMonth(now.getMonth() - 5 + i)
        monthNames.push(`${d.getMonth() + 1}Êúà`)
    }

    // ÁªüËÆ°ÊØè‰∏™ÊúàÁöÑÊñ∞Áî®Êà∑Êï∞Èáè
    usersData.forEach(user => {
        if (!user.createdAt) return

        const createDate = new Date(user.createdAt)
        // Âè™ÁªüËÆ°ÂçäÂπ¥ÂÜÖÁöÑÊï∞ÊçÆ
        if (createDate >= sixMonthsAgo) {
            // ËÆ°ÁÆó‰∏éÊúÄÊó©Êúà‰ªΩÁöÑÊúà‰ªΩÂ∑Æ
            const monthDiff = (createDate.getFullYear() - sixMonthsAgo.getFullYear()) * 12 +
                createDate.getMonth() - sixMonthsAgo.getMonth()

            if (monthDiff >= 0 && monthDiff < 6) {
                monthlyData[monthDiff]++
            }
        }
    })

    // Êõ¥Êñ∞Áî®Êà∑Â¢ûÈïøÊï∞ÊçÆ
    userGrowthData.value = monthNames.map((month, index) => ({
        month,
        value: monthlyData[index]
    }))

    // ËÆ°ÁÆóÂêåÊØîÂ¢ûÈïøÁéáÔºàÁî®ÊúÄËøë‰∏Ä‰∏™Êúà‰∏é‰∏ä‰∏Ä‰∏™ÊúàÊØîËæÉÔºâ
    const currentMonth = monthlyData[5] || 0
    const prevMonth = monthlyData[4] || 1 // ÈÅøÂÖçÈô§‰ª•0
    stats.value.userGrowth = Math.round(((currentMonth - prevMonth) / prevMonth) * 100)

    // Ëé∑ÂèñÊåâÂàõÂª∫Êó∂Èó¥ÊéíÂ∫èÁöÑÊúÄÊñ∞5‰∏™Áî®Êà∑
    const sortedUsers = [...usersData].sort((a, b) => {
        return new Date(b.createdAt || 0) - new Date(a.createdAt || 0)
    })

    latestUsers.value = sortedUsers.slice(0, 5).map(user => ({
        id: user.account,
        username: user.username || 'Êú™Áü•Áî®Êà∑',
        email: user.email || '',
        avatar: user.avatar || null,
        status: user.status === 'offline' ? 'inactive' : 'active'
    }))
}

// Â§ÑÁêÜÊ¥ªÂä®Êï∞ÊçÆ
const processActivitiesData = (activitiesData) => {
    if (!Array.isArray(activitiesData)) {
        return
    }

    // Êõ¥Êñ∞Ê¥ªÂä®ÊÄªÊï∞
    stats.value.activityCount = activitiesData.length

    // Êõ¥Êñ∞Ê¥ªÂä®Â¢ûÈïøÁéáÔºàÁ§∫‰æãÔºöÂÅáËÆæ8%ÁöÑÂ¢ûÈïøÔºâ
    stats.value.activityGrowth = 8.0

    // ÂàùÂßãÂåñÊâÄÊúâÂàÜÁ±ªËÆ°Êï∞‰∏∫0
    const categoryCounts = {}
    activityCategories.value.forEach(category => {
        categoryCounts[category.id] = 0
    })

    // ËÆ°ÁÆóÊ¥ªÂä®ÂàÜÁ±ªÁªüËÆ°
    activitiesData.forEach(activity => {
        const categoryId = activity.categoryId || 9 // Â¶ÇÊûúÊ≤°ÊúâÂàÜÁ±ªIDÔºåÂΩí‰∏∫"ÂÖ∂‰ªñ"(ID=9)
        categoryCounts[categoryId] = (categoryCounts[categoryId] || 0) + 1
    })

    activityCategoryCounts.value = categoryCounts


    // Ëé∑ÂèñÊåâÂàõÂª∫Êó∂Èó¥ÊéíÂ∫èÁöÑÊúÄÊñ∞5‰∏™Ê¥ªÂä®
    const sortedActivities = [...activitiesData].sort((a, b) => {
        return new Date(b.createdAt || 0) - new Date(a.createdAt || 0)
    })

    latestActivities.value = sortedActivities.slice(0, 5).map(activity => ({
        id: activity.id,
        title: activity.title || 'Êú™ÂëΩÂêçÊ¥ªÂä®',
        address: activity.address || 'Êú™Áü•Âú∞ÂùÄ',
        beginTime: activity.beginTime,
        status: activity.status
    }))
}

// Â§ÑÁêÜÁæ§ÁªÑÊï∞ÊçÆ
const processGroupsData = (groupsData) => {
    if (!Array.isArray(groupsData)) return

    // Êõ¥Êñ∞Áæ§ÁªÑÊÄªÊï∞
    stats.value.groupCount = groupsData.length

    // Êõ¥Êñ∞Áæ§ÁªÑÂ¢ûÈïøÁéáÔºàÁ§∫‰æãÔºöÂÅáËÆæ-2%ÁöÑÂ¢ûÈïøÔºåÂç≥‰∏ãÈôçÔºâ
    stats.value.groupGrowth = -2.0

    // Êõ¥Êñ∞‰ªäÊó•Ê¥ªË∑ÉÂíåÊ¥ªË∑ÉÂ¢ûÈïøÔºàÁ§∫‰æãÊï∞ÊçÆÔºâ
    stats.value.activeToday = 489
    stats.value.activeGrowth = 15.6
}

// ÁªÑ‰ª∂ÊåÇËΩΩÊó∂Ëé∑ÂèñÊï∞ÊçÆ
onMounted(() => {
    fetchAllData()
})
</script>

<style scoped>
.dashboard {
    padding: 20rpx;
    background-color: #f5f7fa;
    min-height: 100vh;
}

/* Âä†ËΩΩÂíåÈîôËØØÁä∂ÊÄÅ */
.loading, .error {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 400rpx;
    color: #666;
}

.retry-btn {
    margin-top: 20rpx;
    padding: 10rpx 20rpx;
    background-color: #007aff;
    color: white;
    border: none;
    border-radius: 8rpx;
}

.dashboard-content {
    display: flex;
    flex-direction: column;
    gap: 30rpx;
}

/* ÁªüËÆ°Âç°Áâá */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20rpx;
}

.stat-card {
    background: white;
    padding: 30rpx;
    border-radius: 16rpx;
    box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    gap: 20rpx;
}

.stat-icon {
    width: 80rpx;
    height: 80rpx;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40rpx;
}

.user-icon {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.activity-icon {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.group-icon {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.active-icon {
    background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
}

.stat-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8rpx;
}

.stat-number {
    font-size: 48rpx;
    font-weight: bold;
    color: #2c3e50;
}

.stat-label {
    font-size: 28rpx;
    color: #7f8c8d;
}

.stat-desc {
    font-size: 24rpx;
    color: #95a5a6;
}

.up {
    color: #27ae60;
}

.down {
    color: #e74c3c;
}

/* ÂõæË°®Âå∫Âüü */
.charts-section {
    display: flex;
    flex-direction: column;
    gap: 30rpx;
}

.chart-card {
    background: white;
    border-radius: 16rpx;
    box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.chart-header {
    padding: 30rpx;
    border-bottom: 1rpx solid #eee;
}

.chart-title {
    font-size: 32rpx;
    font-weight: bold;
    color: #2c3e50;
}

.chart-content {
    padding: 30rpx;
}

/* ÊäòÁ∫øÂõæ */
.line-chart {
    position: relative;
    height: 400rpx;
}

.chart-y-axis {
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 60rpx;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: flex-end;
    padding-right: 10rpx;
}

.y-axis-label {
    font-size: 24rpx;
    color: #95a5a6;
}

.chart-area {
    position: absolute;
    left: 70rpx;
    top: 0;
    right: 0;
    height: 100%;
}

.chart-grid {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.grid-line {
    height: 1rpx;
    background-color: #ecf0f1;
}

.chart-line {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
}

.data-point {
    position: absolute;
    width: 12rpx;
    height: 12rpx;
    background-color: #3498db;
    border-radius: 50%;
    transform: translate(-50%, 50%);
    box-shadow: 0 2rpx 8rpx rgba(52, 152, 219, 0.3);
}

.chart-x-axis {
    position: absolute;
    bottom: -40rpx;
    left: 70rpx;
    right: 0;
    display: flex;
    justify-content: space-between;
}

.x-axis-label {
    font-size: 24rpx;
    color: #95a5a6;
}

/* È•ºÂõæ */
.pie-chart-container {
    display: flex;
    align-items: center;
    gap: 40rpx;
}

.pie-chart {
    width: 200rpx;
    height: 200rpx;
    border-radius: 50%;
    position: relative;
}

.pie-slice {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.pie-slice.highlighted {
    transform: scale(1.05);
}

.pie-legend {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16rpx;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 16rpx;
    padding: 12rpx;
    border-radius: 8rpx;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.legend-item:hover,
.legend-item.highlighted {
    background-color: #f8f9fa;
}

.legend-color {
    width: 24rpx;
    height: 24rpx;
    border-radius: 4rpx;
}

.legend-text {
    font-size: 28rpx;
    color: #2c3e50;
}

/* ÊúÄÊñ∞Êï∞ÊçÆÂå∫Âüü */
.latest-section {
    display: flex;
    flex-direction: column;
    gap: 30rpx;
}

.latest-card {
    background: white;
    border-radius: 16rpx;
    box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.latest-header {
    padding: 30rpx;
    border-bottom: 1rpx solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.latest-title {
    font-size: 32rpx;
    font-weight: bold;
    color: #2c3e50;
}

.more-link {
    font-size: 28rpx;
    color: #3498db;
    cursor: pointer;
}

.latest-content {
    padding: 0 30rpx 30rpx;
}

/* Áî®Êà∑È°π */
.user-item {
    display: flex;
    align-items: center;
    gap: 20rpx;
    padding: 20rpx 0;
    border-bottom: 1rpx solid #f1f2f6;
}

.user-item:last-child {
    border-bottom: none;
}

.user-avatar {
    width: 80rpx;
    height: 80rpx;
    border-radius: 50%;
    overflow: hidden;
}

.user-avatar-img {
    width: 100%;
    height: 100%;
}

.user-avatar-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 32rpx;
    font-weight: bold;
}

.user-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8rpx;
}

.user-name {
    font-size: 30rpx;
    font-weight: 500;
    color: #2c3e50;
}

.user-email {
    font-size: 26rpx;
    color: #7f8c8d;
}

.user-status {
    padding: 8rpx 16rpx;
    border-radius: 20rpx;
    font-size: 24rpx;
}

/* Ê¥ªÂä®È°π */
.activity-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20rpx 0;
    border-bottom: 1rpx solid #f1f2f6;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8rpx;
}

.activity-title {
    font-size: 30rpx;
    font-weight: 500;
    color: #2c3e50;
}

.activity-meta {
    font-size: 26rpx;
    color: #7f8c8d;
}

.activity-status {
    padding: 8rpx 16rpx;
    border-radius: 20rpx;
    font-size: 24rpx;
}

/* Áä∂ÊÄÅÊ†∑Âºè */
.status-active {
    background-color: #d4edda;
    color: #155724;
}

.status-inactive {
    background-color: #f8d7da;
    color: #721c24;
}

.status-banned {
    background-color: #f5c6cb;
    color: #721c24;
}

.status-waiting {
    background-color: #fff3cd;
    color: #856404;
}

.status-full {
    background-color: #f8d7da;
    color: #721c24;
}

.status-ongoing {
    background-color: #d1ecf1;
    color: #0c5460;
}

.status-ended {
    background-color: #e2e3e5;
    color: #383d41;
}

.status-cancelled {
    background-color: #f5c6cb;
    color: #721c24;
}

.status-unknown {
    background-color: #e2e3e5;
    color: #6c757d;
}
</style>
<!-- #endif -->